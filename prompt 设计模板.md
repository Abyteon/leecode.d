### âœ… åœºæ™¯

ç”¨äºä»æ™ºèƒ½æ±½è½¦ç”¨æˆ·åé¦ˆï¼ˆè®ºå›ã€é—®å·ã€ç¤¾ç¾¤ã€å”®åè®°å½•ç­‰ï¼‰ä¸­æå–è§‚ç‚¹ï¼Œè¿›è¡Œæƒ…æ„Ÿåˆ†æï¼Œå¹¶æ˜ å°„åˆ°æ ‡å‡†åŒ–æ ‡ç­¾ä½“ç³»ä¸­ã€‚

---

### ğŸ’¬ Prompt æ¨¡æ¿ï¼ˆä¸­æ–‡ç¤ºä¾‹ï¼‰

> ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„æ±½è½¦è¡Œä¸šèˆ†æƒ…åˆ†æä¸“å®¶ã€‚è¯·ä»ä¸‹é¢ç”¨æˆ·åé¦ˆä¸­å®Œæˆä»¥ä¸‹ä»»åŠ¡ï¼š
> 
> 1ï¸âƒ£ æå–æ‰€æœ‰æ¶‰åŠäº§å“æˆ–ä½“éªŒçš„å…·ä½“è§‚ç‚¹ï¼ˆå¯ä¸ºæ­£é¢ã€è´Ÿé¢æˆ–ä¸­æ€§ï¼‰ã€‚
> 
> 2ï¸âƒ£ å¯¹æ¯æ¡è§‚ç‚¹è¿›è¡Œæƒ…æ„Ÿåˆ¤æ–­ï¼ˆæ­£é¢ã€è´Ÿé¢æˆ–ä¸­æ€§ï¼‰ã€‚
> 
> 3ï¸âƒ£ æ ¹æ®ä»¥ä¸‹é¢„å®šä¹‰æ ‡ç­¾ä½“ç³»ï¼Œä¸ºæ¯æ¡è§‚ç‚¹æ˜ å°„æ ‡ç­¾ã€‚å¦‚æœæ— æ³•æ˜ å°„ï¼Œæ ‡æ³¨ä¸ºã€Œå…¶ä»–ã€ã€‚
> 
> 4ï¸âƒ£ ç”Ÿæˆä¸€æ¡æ•´ä½“æ€»ç»“æ€§è¯„è®ºï¼Œæ¦‚æ‹¬ä¸»è¦è§‚ç‚¹ï¼ˆ50 å­—ä»¥å†…ï¼‰ã€‚
> 
> ### ç”¨æˆ·åé¦ˆï¼š
> 
> {user_feedback_text}
> 
> ### æ ‡ç­¾ä½“ç³»ï¼ˆç¤ºä¾‹ï¼‰ï¼š
> 
> - åŠŸèƒ½ï¼šæ™ºé©¾ã€è‡ªåŠ¨æ³Šè½¦ã€å¯¼èˆªã€è¯­éŸ³åŠ©æ‰‹
>     
> - æ€§èƒ½ï¼šç»­èˆªã€åŠ¨åŠ›ã€èƒ½è€—ã€åŠ é€Ÿ
>     
> - èˆ’é€‚æ€§ï¼šåº§æ¤…ã€ç©ºè°ƒã€æ‚¬æŒ‚ã€éš”éŸ³
>     
> - å“ç‰Œä¸æœåŠ¡ï¼šOTA å‡çº§ã€å”®åä½“éªŒã€è½¯ä»¶ç¨³å®šæ€§
>     
> - å…¶ä»–
>     
> 
> ### è¾“å‡º JSON æ ¼å¼ç¤ºä¾‹ï¼š
> 
> json
> 
> å¤åˆ¶ç¼–è¾‘
> 
> `{   "è§‚ç‚¹åˆ—è¡¨": [     {       "è§‚ç‚¹": "è¯­éŸ³åŠ©æ‰‹æœ‰æ—¶å€™ååº”å¤ªæ…¢",       "æƒ…æ„Ÿ": "è´Ÿé¢",       "æ ‡ç­¾": "åŠŸèƒ½-è¯­éŸ³åŠ©æ‰‹"     },     {       "è§‚ç‚¹": "åŠ é€Ÿéå¸¸é¡ºç•…",       "æƒ…æ„Ÿ": "æ­£é¢",       "æ ‡ç­¾": "æ€§èƒ½-åŠ é€Ÿ"     }   ],   "æ€»ç»“": "ç”¨æˆ·å¯¹åŠ é€Ÿè¡¨ç°æ»¡æ„ï¼Œä½†è¯­éŸ³åŠ©æ‰‹å­˜åœ¨å“åº”æ…¢çš„é—®é¢˜" }`

---

### ğŸ’¡ è‹±æ–‡ç‰ˆ Promptï¼ˆå¯ä¾›å›½é™…ç”¨æˆ·æˆ–è®­ç»ƒå¯¹æ¯”ï¼‰

> You are an expert automotive user feedback analyst. Please extract all product- or experience-related opinions from the text below. For each opinion, determine sentiment (positive, negative, or neutral), and map it to the given predefined tag system. If no suitable tag exists, mark as "Other". Also, generate a brief overall summary (max 50 words).
> 
> ...

---

# ğŸ·ï¸ 2ï¸âƒ£ æ ‡ç­¾ä½“ç³»åˆç¨¿ï¼ˆå«å¸¸ç”¨æ±½è½¦ç”¨æˆ·æ„è§æ ‡ç­¾ï¼‰

ä¸‹é¢è¿™ä»½æ ‡ç­¾ä½“ç³»å¯ä»¥ç›´æ¥ä½œä¸ºã€Œè§‚ç‚¹æ ‡å‡†åŒ–å±‚ã€çš„ç¬¬ä¸€ç‰ˆæœ¬ï¼Œåç»­å¯ä»¥æ ¹æ®çœŸå®åé¦ˆä¸æ–­ç»†åŒ–ã€æ‰©å……ã€‚

---

## ğŸš— ä¸€çº§æ ‡ç­¾ï¼šåŠŸèƒ½

| äºŒçº§æ ‡ç­¾   | æè¿°                           |
| ------ | ---------------------------- |
| æ™ºé©¾     | é«˜é€ŸNOAã€åŸåŒºNOAã€è‡ªåŠ¨å˜é“ã€è‡ªåŠ¨æ³Šè½¦ç­‰è¾…åŠ©é©¾é©¶ä½“éªŒ |
| è¯­éŸ³åŠ©æ‰‹   | å”¤é†’å‡†ç¡®åº¦ã€å“åº”é€Ÿåº¦ã€è¯­ä¹‰ç†è§£              |
| å¯¼èˆª     | è·¯çº¿å‡†ç¡®æ€§ã€äº¤äº’ä½“éªŒã€å®æ—¶è·¯å†µ              |
| ç¯å…‰     | è‡ªåŠ¨å¤§ç¯ã€è‡ªé€‚åº”è¿œå…‰ã€è½¦å†…æ°›å›´ç¯             |
| OTA å‡çº§ | æ›´æ–°é¢‘ç‡ã€ç¨³å®šæ€§ã€åŠŸèƒ½æ”¹è¿›                |

---

## âš¡ ä¸€çº§æ ‡ç­¾ï¼šæ€§èƒ½

| äºŒçº§æ ‡ç­¾ | æè¿°              |
| ---- | --------------- |
| ç»­èˆª   | çœŸå®ç»­èˆªã€å¤å†¬å­£è¡¨ç°ã€å……ç”µé‡Œç¨‹ |
| åŠ é€Ÿ   | åŠ¨åŠ›å“åº”ã€æ¨èƒŒæ„Ÿ        |
| èƒ½è€—   | ç”µè€—ã€ç»æµæ€§          |
| åˆ¶åŠ¨   | åˆ¶åŠ¨è·ç¦»ã€åˆ¶åŠ¨åŠ›çº¿æ€§åº¦     |

---

## ğŸ›‹ï¸ ä¸€çº§æ ‡ç­¾ï¼šèˆ’é€‚æ€§

| äºŒçº§æ ‡ç­¾ | æè¿°           |
| ---- | ------------ |
| åº§æ¤…   | èˆ’é€‚åº¦ã€åŒ…è£¹æ€§ã€åŠ çƒ­é€šé£ |
| ç©ºè°ƒ   | åˆ¶å†·åˆ¶çƒ­é€Ÿåº¦ã€æ°”å‘³    |
| éš”éŸ³   | è¡Œé©¶å™ªéŸ³ã€é£å™ªã€èƒå™ª   |
| æ‚¬æŒ‚   | é¢ ç°¸æ„Ÿã€æ”¯æ’‘æ€§      |

---

## ğŸ¢ ä¸€çº§æ ‡ç­¾ï¼šå“ç‰Œä¸æœåŠ¡

| äºŒçº§æ ‡ç­¾  | æè¿°           |
| ----- | ------------ |
| å”®åä½“éªŒ  | ç»´ä¿®ã€å®¢æœæ€åº¦ã€å“åº”é€Ÿåº¦ |
| è½¯ä»¶ç¨³å®šæ€§ | ç³»ç»Ÿå¡é¡¿ã€é‡å¯é—®é¢˜    |
| ä»·æ ¼æ„ŸçŸ¥  | æ€§ä»·æ¯”ã€é…ç½®ä»·å€¼æ„Ÿ    |

---

## ğŸŒŸ ä¸€çº§æ ‡ç­¾ï¼šå¤–è§‚ä¸å†…é¥°

| äºŒçº§æ ‡ç­¾ | æè¿°         |
| ---- | ---------- |
| å¤–è§‚è®¾è®¡ | æ•´ä½“é€ å‹ã€å‰è„¸ã€å°¾éƒ¨ |
| å†…é¥°è®¾è®¡ | è½¦æœºå¸ƒå±€ã€ç”¨æ–™ã€è´¨æ„Ÿ |

---

## ğŸ’¬ ä¸€çº§æ ‡ç­¾ï¼šå…¶ä»–

- ã€Œå…¶ä»–ã€ï¼šç›®å‰æ ‡ç­¾ä½“ç³»æ— æ³•è¦†ç›–çš„è§‚ç‚¹ï¼ŒåæœŸåŠ¨æ€æ‰©å……ã€‚
    

---

# ğŸ—ï¸ 3ï¸âƒ£ æŠ€æœ¯æ¶æ„å›¾ï¼ˆåˆç¨¿ï¼‰

ä¸‹é¢ç»™ä½ ç”»å¥½ä¸€ä¸ªé€»è¾‘æ¶æ„å›¾æ€è·¯ï¼ˆä¹Ÿå¯å¸®ä½ ç”Ÿæˆå¯è§†åŒ–å›¾ç¨¿ï¼Œå¦‚éœ€è¦æˆ‘å¯ä»¥è¾“å‡ºå¸¦å›¾è¡¨çš„é«˜æ¸…ç‰ˆ PNG / SVG æ–‡ä»¶ ğŸ‘¨â€ğŸ’»ğŸ–¼ï¸ï¼‰ï¼š

javascript

å¤åˆ¶ç¼–è¾‘

`â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚        æ•°æ®é‡‡é›†å±‚             â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ ç¤¾åŒº/è®ºå›çˆ¬è™« â”‚  â”‚ API æ¥å£ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚                â–¼ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚        æ•°æ®å¤„ç†å±‚             â”‚ â”‚ æ¸…æ´—ã€å»é‡ã€åˆ‡å¥ã€è„±æ•å¤„ç†       â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚                â–¼ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚        æ¨¡å‹æ¨ç†å±‚             â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚ â”‚ â”‚ è§‚ç‚¹æå–æ¨¡å‹ â”‚            â”‚ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤            â”‚ â”‚ â”‚ æƒ…æ„Ÿåˆ†ææ¨¡å‹ â”‚            â”‚ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤            â”‚ â”‚ â”‚ æ ‡ç­¾æ˜ å°„æ¨¡å— â”‚            â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚                â–¼ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚        æ ‡å‡†åŒ–è¾“å‡ºå±‚           â”‚ â”‚ JSON / DB å­˜å‚¨ / BI æŠ¥è¡¨æ¥å£ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚                â–¼ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚        åº”ç”¨åˆ†æå±‚             â”‚ â”‚ Dashboard, å·¥å•ç³»ç»Ÿ, è¶‹åŠ¿åˆ†æ   â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜`

---

# ğŸ”¬ 4ï¸âƒ£ æ•°æ®å¤„ç† + æ¨¡å‹è®­ç»ƒæµç¨‹è¯¦ç»†æ–¹æ¡ˆ

## ğŸŒ± æ•°æ®å¤„ç†æµç¨‹

1ï¸âƒ£ æ•°æ®é‡‡é›†

- çˆ¬è™«ï¼ˆç¤¾ç¾¤ã€è®ºå›ã€åª’ä½“è¯„è®ºï¼‰
    
- APIï¼ˆAPP å†…åé¦ˆã€æœåŠ¡å·¥å•ï¼‰
    

2ï¸âƒ£ æ–‡æœ¬æ¸…æ´—

- å»é™¤ HTML æ ‡ç­¾ã€è¡¨æƒ…ç¬¦å·
    
- åˆ†å¥ã€æ ‡å‡†åŒ–ç‰¹æ®Šç¬¦å·
    
- æ•æ„Ÿä¿¡æ¯è„±æ•
    

3ï¸âƒ£ åˆ†å¥ä¸åˆ†å—ï¼ˆè§†é•¿æ–‡æœ¬æ‹†åˆ†ï¼‰

4ï¸âƒ£ ç‰¹å¾å·¥ç¨‹ï¼ˆç”¨äºä¼ ç»Ÿæ¨¡å‹æˆ–æ··åˆæ–¹æ¡ˆï¼‰

---

## âš™ï¸ æ¨¡å‹è®­ç»ƒæµç¨‹

### ğŸ”¹ ä»»åŠ¡ä¸€ï¼šè§‚ç‚¹æå–ï¼ˆOpinion Extractionï¼‰

- æ–¹æ³•ï¼š
    
    - åºåˆ—æ ‡æ³¨ï¼ˆBIO æ ‡ç­¾æ³•ï¼Œæ¨¡å‹å¦‚ BERT-CRFï¼‰
        
    - æˆ–ç«¯åˆ°ç«¯ç”Ÿæˆï¼ˆå¤§æ¨¡å‹ï¼Œç›´æ¥ç”Ÿæˆè§‚ç‚¹ï¼‰
        
- æ•°æ®ï¼š
    
    - æ ‡æ³¨å¥½çš„å¥å­è§‚ç‚¹å—
        
    - è´Ÿä¾‹æ ·æœ¬ï¼ˆæ— è§‚ç‚¹å¥å­ï¼‰
        

---

### ğŸ”¹ ä»»åŠ¡äºŒï¼šæƒ…æ„Ÿåˆ†æï¼ˆSentiment Classificationï¼‰

- æ–¹æ³•ï¼š
    
    - å¤šåˆ†ç±»ï¼ˆæ­£é¢ã€ä¸­æ€§ã€è´Ÿé¢ï¼‰
        
    - å¸¸ç”¨æ¨¡å‹ï¼šRoBERTaã€MacBERTï¼ˆä¸­æ–‡ï¼‰ã€æˆ–å¤§æ¨¡å‹è¡¥å¼º
        
- æ•°æ®ï¼š
    
    - åŸºäºäººå·¥æ ‡æ³¨çš„æƒ…æ„Ÿæ ‡ç­¾
        
    - å¯è¾…åŠ©ä½¿ç”¨æƒ…æ„Ÿè¯å…¸è¿‡æ»¤
        

---

### ğŸ”¹ ä»»åŠ¡ä¸‰ï¼šæ ‡ç­¾å½’ç±»ï¼ˆMapping to Tagsï¼‰

- æ–¹æ³•ï¼š
    
    - ç›´æ¥åˆ†ç±»å™¨ï¼ˆSoftmaxï¼Œn åˆ†ç±»ï¼‰
        
    - æˆ–è€…å¤§æ¨¡å‹åŸºäºæ ‡ç­¾ä½“ç³»ç”Ÿæˆ
        
- æ•°æ®ï¼š
    
    - æ ‡ç­¾ä½“ç³»ä¸­çš„å¯¹åº”è®­ç»ƒå¯¹
        

---

### ğŸ”¹ ä»»åŠ¡å››ï¼ˆå¯é€‰ï¼‰ï¼šå¤šä»»åŠ¡è”åˆè®­ç»ƒ

- è”åˆä»»åŠ¡æŸå¤±å‡½æ•°ï¼ˆè§‚ç‚¹æŠ½å– + æƒ…æ„Ÿåˆ†ç±» + æ ‡ç­¾åˆ†ç±»ï¼‰
    

---

## âœ… æ¨¡å‹è¯„ä¼°

- æŒ‡æ ‡ï¼š
    
    - ç²¾ç¡®ç‡ã€å¬å›ç‡ã€F1
        
    - æ ‡ç­¾å‡†ç¡®ç‡
        
- éªŒè¯æ–¹æ³•ï¼š
    
    - ç•™å‡ºé›†æµ‹è¯•
        
    - é•¿å°¾å¤æ‚åœºæ™¯ï¼ˆå¦‚å¤åˆè§‚ç‚¹ï¼‰
        

---

## ğŸš€ æ¨¡å‹ä¸Šçº¿

- æ¨¡å‹ç‰ˆæœ¬ç®¡ç†ï¼ˆMLflow / å†…éƒ¨å¹³å°ï¼‰
    
- æ¨ç†æœåŠ¡ï¼ˆFlask/FastAPIï¼Œæˆ–ä½¿ç”¨ Triton Inference Serverï¼‰
    
- ä¸åå°æ•°æ®å’Œä¸šåŠ¡æ¥å£é›†æˆ
    

---

# ğŸŸ¢ âœ… æ€»ç»“

âœ” è¿™å››ä¸ªéƒ¨åˆ†å¯ä»¥ä¸€èµ·æ„æˆå®Œæ•´çš„èˆ†æƒ…è§‚ç‚¹æå– + æ ‡å‡†åŒ–çš„äº§å“æ–¹æ¡ˆ

å¦‚æœéœ€è¦ï¼Œæˆ‘å¯ä»¥è¿›ä¸€æ­¥å¸®ä½ ï¼š

- ç”»å‡ºå®Œæ•´é«˜æ¸…æ¶æ„å›¾ï¼ˆå«æµç¨‹ã€æ¨¡å‹èŠ‚ç‚¹ã€æ•°æ®æµï¼‰
    
- æ•´ç†æˆ PPT æˆ–æ–‡æ¡£å½¢å¼ï¼ˆä¸­/è‹±æ–‡åŒè¯­ï¼‰
    
- å‡ºè¯¦ç»†çš„ prompt + æ ‡ç­¾ä½“ç³» Excel æ–‡ä»¶
    
- ç”šè‡³å†™å‡ºæ ¸å¿ƒä»£ç ï¼ˆæ¯”å¦‚è§‚ç‚¹æå–æ ‡æ³¨æ¨¡å‹ç¤ºä¾‹ï¼Œæˆ–å¤§æ¨¡å‹ prompt ä»£ç å°è£…ï¼‰


## NSS ç”¨æˆ·åé¦ˆè§‚ç‚¹æå–â€”â€”è¯¦ç»†æ–¹æ¡ˆä¸ä»£ç ç¤ºä¾‹

ä»¥ä¸‹æ–¹æ¡ˆåˆ†ä¸ºäº”ä¸ªæ¨¡å—ï¼š

1. æ•°æ®å‡†å¤‡ä¸æ ‡æ³¨ç¤ºä¾‹
    
2. Embedding + è½»é‡åˆ†ç±»å™¨è®­ç»ƒ
    
3. LLM å¤šæ­¥æ‹†åˆ† + function calling
    
4. ç»¼åˆæ¨ç† Pipeline
    
5. Active Learning & è¿­ä»£è¡¥æ ‡
    

---

### 1. æ•°æ®å‡†å¤‡ä¸æ ‡æ³¨ç¤ºä¾‹

```python
# å‡è®¾ä»å†å² NSS æ•°æ®ä¸­æŠ½å–çš„é«˜è´¨é‡æ ‡æ³¨ç¤ºä¾‹
annotated_samples = [
    {
        "id": 1,
        "feedback": "ç•Œé¢åŠ è½½å¤ªæ…¢ï¼Œå¡é¡¿æ˜æ˜¾",
        "aspect": "æ€§èƒ½",
        "sentiment": "è´Ÿé¢",
        "opinion": "åŠ è½½æ…¢"
    },
    {
        "id": 2,
        "feedback": "å¯¼èˆªåŠŸèƒ½å¾ˆå®ç”¨ï¼Œè·¯å¾„è§„åˆ’å‡†ç¡®",
        "aspect": "åŠŸèƒ½",
        "sentiment": "æ­£é¢",
        "opinion": "è·¯å¾„è§„åˆ’å‡†ç¡®"
    },
    # æ›´å¤šç¤ºä¾‹...
]
```

- **taxonomy**ï¼š`["ç•Œé¢", "æ€§èƒ½", "åŠŸèƒ½", "å®¢æœ", "å…¶ä»–"]`
    
- **sentiment**ï¼š`["æ­£é¢", "ä¸­ç«‹", "è´Ÿé¢"]`
    

---

### 2. Embedding + è½»é‡åˆ†ç±»å™¨è®­ç»ƒ

```python
import numpy as np
from sklearn.linear_model import LogisticRegression
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import LabelEncoder
import openai

# 1) è·å– embeddings
openai.api_key = "YOUR_API_KEY"
def embed(texts):
    resp = openai.Embedding.create(model="text-embedding-ada-002", input=texts)
    return np.array([d.embedding for d in resp.data])

texts = [s['feedback'] for s in annotated_samples]
X = embed(texts)

# 2) æ ‡ç­¾ç¼–ç 
le_aspect = LabelEncoder().fit([s['aspect'] for s in annotated_samples])
le_sent = LabelEncoder().fit([s['sentiment'] for s in annotated_samples])
y_aspect = le_aspect.transform([s['aspect'] for s in annotated_samples])
y_sent = le_sent.transform([s['sentiment'] for s in annotated_samples])

# 3) è®­ç»ƒåˆ†ç±»å™¨
X_train, X_val, ya_train, ya_val = train_test_split(X, y_aspect, test_size=0.2, random_state=42)
clf_aspect = LogisticRegression(max_iter=200).fit(X_train, ya_train)

X_train2, X_val2, ys_train, ys_val = train_test_split(X, y_sent, test_size=0.2, random_state=42)
clf_sent = LogisticRegression(max_iter=200).fit(X_train2, ys_train)

print("Aspect åˆ†ç±»å‡†ç¡®ç‡ï¼š", clf_aspect.score(X_val, ya_val))
print("Sentiment åˆ†ç±»å‡†ç¡®ç‡ï¼š", clf_sent.score(X_val2, ys_val))
```

---

### 3. LLM å¤šæ­¥æ‹†åˆ† + Function Calling

```python
# å®šä¹‰ function schema
functions = [
    {
        "name": "extract_opinion",
        "description": "ä»ä¸€å¥åé¦ˆä¸­æå–è§‚ç‚¹ã€ç»´åº¦å’Œæƒ…æ„Ÿ",
        "parameters": {
            "type": "object",
            "properties": {
                "aspect": {"type": "string", "enum": ["ç•Œé¢","æ€§èƒ½","åŠŸèƒ½","å®¢æœ","å…¶ä»–"]},
                "sentiment": {"type": "string", "enum": ["æ­£é¢","ä¸­ç«‹","è´Ÿé¢"]},
                "opinion": {"type": "string"}
            },
            "required": ["aspect","sentiment","opinion"]
        }
    }
]

# æ„é€ å¤šæ­¥ Prompt
template = '''You are an expert in product feedback analysis.
Steps:
1. æå– "opinion"ï¼ˆç®€æ˜ä¸€å¥è¯ï¼‰
2. åˆ¤æ–­ "aspect"
3. åˆ¤æ–­ "sentiment"
Respond by calling function `extract_opinion`.'''  

from openai import ChatCompletion

def llm_extract(text):
    resp = ChatCompletion.create(
        model="gpt-4o-mini",
        messages=[{"role":"user","content": template + "\nFeedback: \"" + text + "\""}],
        functions=functions,
        function_call={"name":"extract_opinion"}
    )
    # è§£æè¿”å›å†…å®¹
    args = resp.choices[0].message['function_call']['arguments']
    import json
    return json.loads(args)

# æµ‹è¯•
print(llm_extract("æ˜¨å¤©ä¸‹åˆè½¯ä»¶çªç„¶å´©æºƒï¼Œæ— æ³•ä½¿ç”¨"))
```

---

### 4. ç»¼åˆæ¨ç† Pipeline

```python
def analyze_feedback(feedback, threshold=0.8):
    vec = embed([feedback])[0]
    # Embedding åˆ†ç±»
    prob_aspect = clf_aspect.predict_proba([vec])[0]
    prob_sent  = clf_sent.predict_proba([vec])[0]
    if max(prob_aspect) > threshold and max(prob_sent) > threshold:
        return {
            "aspect": le_aspect.inverse_transform([prob_aspect.argmax()])[0],
            "sentiment": le_sent.inverse_transform([prob_sent.argmax()])[0],
            "opinion": feedback  # ç›´æ¥ç”¨åŸå¥æˆ–ç®€åŒ–
        }
    # å¦åˆ™è°ƒç”¨ LLM
    return llm_extract(feedback)

# ç¤ºä¾‹æ‰¹é‡å¤„ç†
feedback_list = [s['feedback'] for s in annotated_samples]
results = [analyse_feedback(f) for f in feedback_list]
print(results)
```

---

### 5. Active Learning & è¿­ä»£è¡¥æ ‡

1. å°†ç½®ä¿¡åº¦ä½ (< threshold) æˆ– LLM è¾“å‡ºè´¨é‡å·®çš„æ ·æœ¬æ”¶é›†åˆ° `uncertain_pool`ã€‚
    
2. äººå·¥æ ¡å¯¹/è¡¥æ ‡åè¿½åŠ åˆ° `annotated_samples`ï¼Œå¹¶é‡æ–°è®­ç»ƒåˆ†ç±»å™¨ã€‚
    
3. å‘¨æœŸæ€§é‡å¤ï¼šä¸æ–­æ‰©å¤§é«˜è´¨é‡æ ‡æ³¨é›†ã€‚
    

---

ä»¥ä¸Šå³ä¸ºä¸€ä¸ªç«¯åˆ°ç«¯çš„è¯¦ç»†æ–¹æ¡ˆä¸ä»£ç ç¤ºä¾‹ï¼Œä½ å¯ä»¥æ ¹æ®å®é™…ä¸šåŠ¡é‡ã€é˜ˆå€¼å’Œéƒ¨ç½²ç¯å¢ƒï¼Œè¿›ä¸€æ­¥è°ƒæ•´è¶…å‚ã€å¹¶è¡Œæˆ–æ‰¹å¤„ç†æ–¹å¼ï¼Œæˆ–å°†å…¶å°è£…ä¸ºå¾®æœåŠ¡ï¼ˆå¦‚ FastAPI + Kubernetesï¼‰ã€‚

---

### 6. ç”¨æˆ·åé¦ˆé‡å†™ï¼ˆParaphrasingï¼‰æ¨¡å—

ä¸ºäº†æå‡é‡å†™çš„**ç²¾ç¡®åº¦**å’Œ**ä¸“ä¸šæ€§**ï¼Œå¯ä»¥ä»ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ä¼˜åŒ–ï¼š

1. **Prompt å·¥ç¨‹ä¸ Fewâ€‘Shot ç¤ºä¾‹**
    
    - åœ¨ Prompt å‰åŠ å…¥ç³»ç»Ÿè§’è‰²è¯´æ˜ï¼Œè®©æ¨¡å‹è§’è‰²å®šä½ä¸ºâ€œèµ„æ·±äº§å“ç»ç†â€æˆ–â€œä¸“ä¸šæ–‡æ¡ˆä¸“å®¶â€ã€‚
        
    - æä¾› 2â€“3 ä¸ªé«˜è´¨é‡çš„â€œåŸæ–‡â†’æ”¹å†™â€ç¤ºä¾‹ï¼Œå±•ç¤ºèŒƒå¼ã€ç”¨è¯å’Œæ ¼å¼ã€‚
        
    - ä½¿ç”¨æ˜ç¡®çš„æŒ‡ä»¤æ¨¡æ¿ï¼Œä¾‹å¦‚ï¼š
        
        ```text
        ä½ æ˜¯ä¸€åèµ„æ·±äº§å“ç»ç†ï¼Œè¯·å°†ç”¨æˆ·åé¦ˆæŒ‰â€œä¸“ä¸šç®€æ´ã€æœ¯è¯­å‡†ç¡®â€çš„è¦æ±‚æ”¹å†™ã€‚
        ç¤ºä¾‹ï¼š
        åŸæ–‡ï¼šç•Œé¢åŠ è½½å¤ªæ…¢ï¼Œå¡é¡¿æ˜æ˜¾
        æ”¹å†™ï¼šç•Œé¢å“åº”å»¶è¿Ÿä¸¥é‡ï¼Œéœ€ä¼˜åŒ–åŠ è½½æ€§èƒ½ã€‚
        
        åŸæ–‡ï¼šå¯¼èˆªåŠŸèƒ½å¾ˆå®ç”¨ï¼Œè·¯å¾„è§„åˆ’å‡†ç¡®
        æ”¹å†™ï¼šå¯¼èˆªæ¨¡å—æ€§èƒ½ä¼˜å¼‚ï¼Œè·¯å¾„æŒ‡å¼•ç²¾å‡†å¯é ã€‚
        
        è¯·æ”¹å†™ï¼š{text}
        ```
        
2. **ä½¿ç”¨ Domainâ€‘Specific Glossaryï¼ˆæœ¯è¯­è¡¨ï¼‰**
    
    - é¢„å…ˆå®šä¹‰å¸¸ç”¨æœ¯è¯­ä¸æ ‡å‡†è¡¨è¾¾ï¼Œä¾‹å¦‚â€œå¡é¡¿â€â†’â€œå“åº”å»¶è¿Ÿâ€ã€â€œé—ªé€€â€â†’â€œå´©æºƒå¼‚å¸¸â€ã€‚
        
    - åœ¨ Prompt ä¸­é™„å¸¦æœ¯è¯­å¯¹ç…§è¡¨ï¼Œæˆ–è®©æ¨¡å‹ä¸¥æ ¼æ›¿æ¢ä¸ºæœ¯è¯­è¡¨ä¸­çš„è¯æ±‡ã€‚
        
3. **Temperature ä¸ Topâ€‘k æ§åˆ¶**
    
    - **Temperatureï¼ˆæ¸©åº¦ï¼‰** æ˜¯ä¸€ä¸ªæ§åˆ¶æ¨¡å‹è¾“å‡ºéšæœºæ€§ï¼ˆå¤šæ ·æ€§ï¼‰çš„é‡è¦è¶…å‚æ•°ï¼Œå…¶å–å€¼èŒƒå›´é€šå¸¸ä¸º `0.0â€“1.0`ï¼š
        
        - **ä½æ¸©åº¦ï¼ˆ0.0â€“0.3ï¼‰**ï¼šè¾“å‡ºæ›´åŠ ç¡®å®šå’Œä¿å®ˆï¼Œæ›´è´´è¿‘é¢„è®­ç»ƒæ—¶æœ€é«˜æ¦‚ç‡çš„è¯æ±‡ï¼Œé€‚åˆéœ€è¦ç²¾å‡†ã€å¯é¢„æµ‹ç»“æœçš„åœºæ™¯ï¼Œå¦‚è§‚ç‚¹é‡å†™ã€ä»£ç ç”Ÿæˆã€‚
            
        - **ä¸­æ¸©åº¦ï¼ˆ0.4â€“0.7ï¼‰**ï¼šåœ¨ä¿çœŸåº¦ä¸å¤šæ ·æ€§ä¹‹é—´åšæŠ˜ä¸­ï¼Œæ—¢èƒ½é€‚å½“åˆ›æ–°ï¼Œä¹Ÿä¸è‡³äºè¿‡äºå‘æ•£ï¼Œé€‚ç”¨äºåˆ›æ„æç¤ºæˆ–æ‘˜è¦ã€‚
            
        - **é«˜æ¸©åº¦ï¼ˆ0.8â€“1.0ï¼‰**ï¼šæ¨¡å‹ä¼šé€‰æ‹©æ›´å¤šä½æ¦‚ç‡è¯æ±‡ï¼Œè¾“å‡ºæ›´å…·åˆ›æ„å’Œå¤šæ ·æ€§ï¼Œä½†å¯æ§æ€§ä¸å‡†ç¡®æ€§ä¸‹é™ï¼Œé€‚ç”¨äºå¤´è„‘é£æš´ã€è¯—æ­Œåˆ›ä½œã€‚
            
    - **Topâ€‘k / Topâ€‘p (nucleus sampling)**ï¼š
        
        - **Topâ€‘k**ï¼šä»…ä»æ¦‚ç‡æœ€é«˜çš„ `k` ä¸ªè¯æ±‡ä¸­é‡‡æ ·ï¼Œé™åˆ¶è¾“å‡ºç©ºé—´ï¼›
            
        - **Topâ€‘p**ï¼šä»ç´¯è®¡æ¦‚ç‡è¾¾åˆ° `p` çš„è¯æ±‡ä¸­é‡‡æ ·ï¼Œæ›´åŠ¨æ€åœ°æ§åˆ¶é‡‡æ ·ç©ºé—´ã€‚
            
    - **å»ºè®®**ï¼šå¯¹äºâ€œä¸“ä¸šç®€æ´â€çš„é‡å†™ä»»åŠ¡ï¼Œå°† `temperature=0.0â€“0.3`ï¼Œ`top_p=0.9` ä½œä¸ºåˆå§‹é…ç½®ï¼Œä»¥ç¡®ä¿ç»“æœæ—¢ç¬¦åˆæœ¯è¯­è¡¨ï¼Œåˆå…·æœ‰é€‚å½“å¤šæ ·æ€§ã€‚
        
4. **åå¤„ç†ä¸æ ¡éªŒ** **åå¤„ç†ä¸æ ¡éªŒ**
    
    - å¯¹é‡å†™ç»“æœè¿›è¡Œç®€å•è§„åˆ™æ ¡éªŒï¼š
        
        - **é•¿åº¦èŒƒå›´**ï¼šé™å®šåœ¨ 10â€“20 å­—ä¹‹é—´ã€‚
            
        - **å…³é”®è¯ä¿ç•™**ï¼šæ£€æŸ¥æ˜¯å¦åŒ…å«åŸåé¦ˆçš„æ ¸å¿ƒæœ¯è¯­ã€‚
            
    - è‹¥æ ¡éªŒä¸é€šè¿‡ï¼Œå¯è‡ªåŠ¨è§¦å‘äºŒæ¬¡é‡å†™ï¼Œæˆ–é™æ¸©é‡å†™ï¼ˆ`temperature=0`ï¼‰ã€‚
        
5. **å¹¶è¡Œä¸æ‰¹é‡å¼‚æ­¥**
    
    - ä½¿ç”¨ `asyncio` + `semaphore` æ§åˆ¶å¹¶å‘ï¼Œé¿å…è¶…å‡º API é™é¢ã€‚
        
    - å¯¹äºå¤§é‡åé¦ˆï¼Œå¯å…ˆåˆ†æ‰¹å†è°ƒç”¨ï¼Œç»“åˆé‡å†™é˜Ÿåˆ—å’Œé‡è¯•æœºåˆ¶ï¼Œç¡®ä¿ç¨³å®šæ€§ã€‚
        

```python
from openai import ChatCompletion
import asyncio

# æœ¯è¯­è¡¨
GLOSSARY = {
    "å¡é¡¿": "å“åº”å»¶è¿Ÿ",
    "å´©æºƒ": "å´©æºƒå¼‚å¸¸",
    # æ›´å¤šæœ¯è¯­...
}

SYSTEM_PROMPT = (
    "ä½ æ˜¯ä¸€åèµ„æ·±äº§å“ç»ç†ï¼Œè¯·æŒ‰â€œä¸“ä¸šç®€æ´ã€æœ¯è¯­å‡†ç¡®â€çš„è¦æ±‚æ”¹å†™ç”¨æˆ·åé¦ˆï¼Œ"
    "ä½¿ç”¨ä¸‹åˆ—è¡¨ä¸­æ ‡å‡†æœ¯è¯­ï¼š" + ", ".join(f"{k}â†’{v}" for k,v in GLOSSARY.items())
)

async def rewrite_feedback_async(text, client, temperature=0.2, top_p=0.9):
    # Few-shot ç¤ºä¾‹
    examples = [
        ("ç•Œé¢åŠ è½½å¤ªæ…¢ï¼Œå¡é¡¿æ˜æ˜¾", "ç•Œé¢å“åº”å»¶è¿Ÿä¸¥é‡ï¼Œéœ€ä¼˜åŒ–åŠ è½½æ€§èƒ½ã€‚"),
        ("å¯¼èˆªåŠŸèƒ½å¾ˆå®ç”¨ï¼Œè·¯å¾„è§„åˆ’å‡†ç¡®", "å¯¼èˆªæ¨¡å—æ€§èƒ½ä¼˜å¼‚ï¼Œè·¯å¾„æŒ‡å¼•ç²¾å‡†å¯é ã€‚"),
    ]
    # æ„å»º messages
    messages = [{"role":"system","content": SYSTEM_PROMPT}]
    for orig, rew in examples:
        messages.append({"role":"user","content": f"åŸæ–‡ï¼š{orig}"})
        messages.append({"role":"assistant","content": f"æ”¹å†™ï¼š{rew}"})
    messages.append({"role":"user","content": f"åŸæ–‡ï¼š{text}
æ”¹å†™ï¼š"})

    resp = await client.acreate(
        model="gpt-4o-mini",
        messages=messages,
        temperature=temperature,
        top_p=top_p,
        max_tokens=256
    )
    result = resp.choices[0].message.content.strip()
    # ç®€å•æ ¡éªŒ
    if not (10 <= len(result) <= 30) or not any(v in result for v in GLOSSARY.values()):
        # è§¦å‘é™æ¸©é‡å†™
        resp2 = await client.acreate(
            model="gpt-4o-mini",
            messages=messages,
            temperature=0.0,
            top_p=top_p,
            max_tokens=256
        )
        result = resp2.choices[0].message.content.strip()
    return result

async def batch_rewrite(texts):
    import openai
    openai.api_key = "YOUR_API_KEY"
    client = openai.ChatCompletion
    sem = asyncio.Semaphore(5)

    async def sem_task(t):
        async with sem:
            return await rewrite_feedback_async(t, client)

    return await asyncio.gather(*(sem_task(t) for t in texts))

# è°ƒç”¨ç¤ºä¾‹ï¼ˆåœ¨å¼‚æ­¥ç¯å¢ƒä¸­ï¼‰
# rewritten = asyncio.run(batch_rewrite([s['feedback'] for s in annotated_samples]))
```

é€šè¿‡ä¸Šè¿°ä¼˜åŒ–ï¼Œä½ å¯ä»¥åœ¨â€œç²¾ç¡®æ€§â€â€œä¸“ä¸šæ€§â€â€œç¨³å®šæ€§â€ä¸Šå¾—åˆ°æ˜¾è‘—æå‡ã€‚
